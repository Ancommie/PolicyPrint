# PolicyPrint
本项目基于https://sousuo.www.gov.cn/ 全文检索含指定主题关键字的条目，并将其打印成PDF格式(主要可选参数：主题检索关键词、标题筛选关键词、存储路径、爬取年份范围等)。


## 项目简介

本项目提供了一套基于 Selenium 和 Edge 浏览器 DevTools 协议的自动化爬取脚本，用于从“中国政府网站内搜索页”（ https://sousuo.www.gov.cn ）中按关键词和时间范围下载政府公文的 PDF 文件。脚本具备以下核心功能：

- 自动翻页检索指定年份区间中内容包含主题关键词的公文列表  
- 筛选标题中包含特定公文类型关键词的条目  
- 利用浏览器 DevTools 接口生成并保存PDF  
- 按年度分类存储

该工具仅供政策文本分析研究使用，请勿用于其他用途。


## 环境依赖

1. **Python 版本**  

   - 建议使用 Python 3.8 及以上  

2. **第三方库**  

   pip install selenium

3. **浏览器驱动**

   * **Microsoft Edge** 浏览器（版本 ≥ 80）
   * 对应版本的 **msedgedriver**


## 参数说明

| 参数名称               | 类型          | 默认值                     | 说明                                                 |
| ------------------ | ----------- | ----------------------- | -------------------------------------------------- |
| `keyword`          | `str`       | `"可持续"`                 | 全文搜索关键词，用于在政务平台中匹配公文内容                             |
| `INCLUDE_KEYWORDS` | `List[str]` | `['决议','决定','命令', …]`   | 文章标题必须包含的文种及主题关键词列表，用于二次筛选                         |
| `BASE_PATH`        | `str`       | `r"D:\\大创\\文档\\政策文件\\"` | 下载文件保存根目录，脚本会在此目录下按年份创建子文件夹                        |
| `YEARS`            | `range`     | `range(2018, 2024)`     | 爬取年份范围（起始年包含，结束年不包含）                               |
| `Sleep_time`       | `int/float` | `1`                     | 翻页及打开文档时的 sleep 间隔（秒），用于防止请求过于频繁导致 IP 被封           |
| `code` / `sign`    | `str`       | 需手动填入                   | 从官网搜索接口中获得的 `code` 与 `sign` 参数，用于合法发起检索请求，避免反爬机制拦截 |

> **提示**：在首次使用前，请手动访问
> `https://sousuo.www.gov.cn`
> 输入任意关键词后，获取 `search.shtml` 请求的 `code` 与 `sign` 参数，填入脚本对应变量。


## 使用步骤

1. **配置驱动并安装依赖**

   - 安装 Selenium库

   - 确保 msedgedriver 已放置在系统 PATH 中，或下载后指定 executable_path
   
2. **填写检索参数**

   * 在脚本顶部逐项修改 `keyword`、`INCLUDE_KEYWORDS`、`BASE_PATH`、`YEARS`、`Sleep_time`
   * 填入从官网抓包取得的 `code`、`sign`

3. **运行脚本**

4. **结果检验**

   * 进入 `BASE_PATH` 指定目录
   * 可看到按年份分文件夹存储的 PDF 文件


## 注意事项

1. **反爬策略**：政务搜索平台可能对短时间大量请求进行限制，请合理设置 `Sleep_time` 并避免大规模并发。
2. **文件名规范**：脚本已对标题中的特殊字符进行替换，仍建议检查保存目录避免同名文件冲突。
3. **DevTools 接口**：`driver.execute_cdp_cmd("Page.printToPDF", …)` 依赖浏览器版本和驱动兼容性，遇到报错请升级 Edge 及 msedgedriver。
4. **法律合规**：请仅用于合法合规的学术研究或政策分析，不得用于商业窃取或恶意分发。


## 联系方式

如有问题或功能改进建议，欢迎联系开发者：

* **邮箱**：zouchuze@gmail.com
